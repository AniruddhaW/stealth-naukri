<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quarterly Budget Review - Google Sheets</title>
    <link rel="icon" href="https://ssl.gstatic.com/docs/spreadsheets/spreadsheets_launcher_icon.png" type="image/png">
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="app-container">
        <button class="emergency-exit" onclick="app.showEmergencyView()">ESC</button>
        
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="sheets-logo">
                    <img src="assets/sheets-logo.png" alt="Sheets">
                    <div class="sheets-title">Quarterly Budget Review</div>
                </div>
                <button class="star-btn">â˜†</button>
            </div>
            <div class="header-right">
                <button class="share-btn">
                    <span class="share-icon">ðŸ”’</span>
                    Share
                </button>
                <div class="avatar" id="userAvatar">A</div>
            </div>
        </div>
        
        <!-- Menu bar -->
        <div class="menu-bar">
            <div class="menu-item">File</div>
            <div class="menu-item">Edit</div>
            <div class="menu-item">View</div>
            <div class="menu-item">Insert</div>
            <div class="menu-item">Format</div>
            <div class="menu-item">Data</div>
            <div class="menu-item">Tools</div>
            <div class="menu-item">Extensions</div>
            <div class="menu-item">Help</div>
        </div>
        
        <!-- Toolbar -->
        <div class="toolbar">
            <!-- Left section -->
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Search (âŒ˜F)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Undo (âŒ˜Z)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Redo (âŒ˜Y)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Print (âŒ˜P)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Paint format">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M18 4V3c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V6h1v4H9v11c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-9h8V4h-3z" fill="#5f6368"/></svg>
                </button>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <div class="toolbar-select">
                    <span>100%</span>
                    <svg width="18" height="18" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z" fill="#5f6368"/></svg>
                </div>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Currency">
                    <span>$</span>
                </button>
                <button class="toolbar-btn" title="Percent">
                    <span>%</span>
                </button>
                <button class="toolbar-btn" title="Decrease decimal places">
                    <span>.0</span>
                </button>
                <button class="toolbar-btn" title="Increase decimal places">
                    <span>.00</span>
                </button>
                <button class="toolbar-btn" title="More formats">
                    <span>123</span>
                </button>
            </div>
        
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <div class="toolbar-select font-select">
                    <span>Default</span>
                    <svg width="18" height="18" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z" fill="#5f6368"/></svg>
                </div>
            </div>
        
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn font-size-decrease" title="Decrease font size">
                    <span>âˆ’</span>
                </button>
                <div class="toolbar-select size-select">
                    <span>10</span>
                </div>
                <button class="toolbar-btn font-size-increase" title="Increase font size">
                    <span>+</span>
                </button>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Bold (âŒ˜B)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Italic (âŒ˜I)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Strikethrough">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M10 19h4v-3h-4v3zM5 4v3h5v3h4V7h5V4H5zM3 14h18v-2H3v2z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Text color">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M11 3L5.5 17h2.25l1.12-3h6.25l1.12 3h2.25L13 3h-2zm-1.38 9L12 5.67 14.38 12H9.62z" fill="#5f6368"/><path d="M3 19h18v3H3v-3z" fill="#34a853"/></svg>
                </button>
                <button class="toolbar-btn" title="Fill color">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z" fill="#5f6368"/><path d="M0 20h24v4H0v-4z" fill="#fbbc05"/></svg>
                </button>
            </div>
        
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Borders">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M3 3v18h18V3H3zm8 16H5v-6h6v6zm0-8H5V5h6v6zm8 8h-6v-6h6v6zm0-8h-6V5h6v6z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Merge cells">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM4 18V6h16v12H4z M7 8h10v2H7z M7 12h10v2H7z" fill="#5f6368"/></svg>
                </button>
            </div>
        
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Horizontal align">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Vertical align">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M8 19h3v4h2v-4h3l-4-4-4 4zm8-14h-3V1h-2v4H8l4 4 4-4zM4 11v2h16v-2H4z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Text wrapping">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3 3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z" fill="#5f6368"/></svg>
                </button>
            </div>
        
            <div class="toolbar-group" style="margin-left: auto;">
                <button class="toolbar-btn" title="More">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill="#5f6368"/></svg>
                </button>
            </div>
            
            <button class="login-btn" id="loginButton" onclick="app.showLoginModal()">Login</button>
            <div class="help-button" onclick="app.showHelpModal()">?</div>
        </div>
        
        <!-- Formula bar -->
        <div class="formula-bar">
            <div class="cell-reference">A9</div>
            <div class="formula-input">
                <div class="formula-equals">=</div>
                <input type="text" class="formula-field" id="searchInput" placeholder="Type job title, skills or company and hit enter">
            </div>
        </div>
        
        <!-- Spreadsheet area -->
        <div class="spreadsheet-container">
            <div class="formula-cell-reference">E12</div>
            <div class="formula-function">fx</div>
            
            <table class="spreadsheet">
                <thead>
                    <tr>
                        <th class="row-header"></th>
                        <th>A</th>
                        <th>B</th>
                        <th>C</th>
                        <th>D</th>
                        <th>E</th>
                        <th>F</th>
                        <th>G</th>
                        <th>H</th>
                        <th>I</th>
                        <th>J</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="row-header">1</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">2</td>
                        <td>Shhh... This isn't a job portal.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">3</td>
                        <td>It's just a totally normal spreadsheet ðŸ‘€</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">4</td>
                        <td>Type your dream job below, scroll like you're working,</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">5</td>
                        <td>and apply without raising a single eyebrow.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">6</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">7</td>
                        <td class="got-it-cell">Activate Stealth Mode</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">8</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">9</td>
                        <td id="searchCell" class="search-cell" style="min-height: 20px;"></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">10</td>
                        <td class="header-cell">Company</td>
                        <td class="header-cell">Position</td>
                        <td class="header-cell">Location</td>
                        <td class="header-cell">Salary</td>
                        <td class="header-cell">Experience</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">11</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">12</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">13</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Sheet tabs -->
        <div class="sheets-tabs">
            <div class="sheet-tab">Sheet1</div>
            <div class="add-sheet">+</div>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div class="gs-modal-overlay" id="loginModal">
        <div class="gs-modal-content gs-sheets-style">
            <div class="gs-modal-header">
                <h2>Login</h2>
                <button class="gs-close-button" onclick="app.hideLoginModal()">Ã—</button>
            </div>
            
            <div class="gs-modal-body">
                <form id="loginForm">
                    <div class="gs-form-row">
                        <label for="email">Email ID / Username</label>
                        <input type="email" id="email" class="gs-text-input" placeholder="Enter your email" required>
                    </div>
                    
                    <div class="gs-form-row">
                        <label for="password">Password</label>
                        <input type="password" id="password" class="gs-text-input" placeholder="Enter your password" required>
                    </div>
                    
                    <div class="gs-checkbox-row">
                        <input type="checkbox" id="googleLogin" class="gs-checkbox">
                        <label for="googleLogin">Sign in with Google</label>
                    </div>
                    
                    <div class="gs-checkbox-row">
                        <input type="checkbox" id="otpLogin" class="gs-checkbox">
                        <label for="otpLogin">Login using OTP</label>
                    </div>
                    
                    <div class="gs-checkbox-row">
                        <input type="checkbox" id="registerNew" class="gs-checkbox">
                        <label for="registerNew">Register for free</label>
                    </div>
                </form>
            </div>
            
            <div class="gs-modal-footer">
                <button type="button" class="gs-button" onclick="app.hideLoginModal()">Cancel</button>
                <button type="button" class="gs-button gs-button-primary" onclick="document.getElementById('loginForm').submit()">Login</button>
            </div>
        </div>
    </div>

    <div id="results" style="display:none;"></div>
    
    <!-- Load JavaScript -->
    <script src="js/app.js"></script>
    

<!-- Consolidated custom scripts -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // 1. Enhance the spreadsheet - add columns and rows
    function enhanceSpreadsheet() {
        // Fix column headers
        const headerRow = document.querySelector('table.spreadsheet thead tr');
        if (headerRow) {
            const columns = headerRow.querySelectorAll('th');
            const lastColumnIndex = columns.length - 1;
            
            if (lastColumnIndex < 26) {
                for (let i = lastColumnIndex; i < 26; i++) {
                    const columnLetter = String.fromCharCode(65 + i);
                    const newHeader = document.createElement('th');
                    newHeader.textContent = columnLetter;
                    headerRow.appendChild(newHeader);
                    
                    const allRows = document.querySelectorAll('table.spreadsheet tbody tr');
                    allRows.forEach(row => {
                        const newCell = document.createElement('td');
                        row.appendChild(newCell);
                    });
                }
            }
        }
        
        // Add additional rows
        const tbody = document.querySelector('table.spreadsheet tbody');
        const existingRows = tbody.querySelectorAll('tr').length;
        const desiredRows = 30;
        
        if (existingRows < desiredRows && headerRow) {
            const columnCount = headerRow.querySelectorAll('th').length - 1;
            
            for (let i = existingRows + 1; i <= desiredRows; i++) {
                const newRow = document.createElement('tr');
                
                const rowHeader = document.createElement('td');
                rowHeader.className = 'row-header';
                rowHeader.textContent = i.toString();
                newRow.appendChild(rowHeader);
                
                for (let j = 0; j < columnCount; j++) {
                    const newCell = document.createElement('td');
                    newRow.appendChild(newCell);
                }
                
                tbody.appendChild(newRow);
            }
        }
    }
    
    // Call enhancement function on load
    enhanceSpreadsheet();
    
    // 2. Avatar dropdown functionality
    const avatar = document.getElementById('userAvatar');
    if (avatar) {
        avatar.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            let dropdown = document.getElementById('userDropdown');
            
            if (dropdown) {
                if (dropdown.style.display === 'block') {
                    dropdown.style.display = 'none';
                } else {
                    dropdown.style.display = 'block';
                }
                return;
            }
            
            dropdown = document.createElement('div');
            dropdown.id = 'userDropdown';
            dropdown.className = 'user-dropdown';
            
            const userData = JSON.parse(localStorage.getItem('naukriUser') || '{}');
            const userName = userData.name || 'Guest User';
            const userEmail = userData.email || '';
            
            dropdown.innerHTML = `
                <div class="user-info">${userName}</div>
                <div class="email-info">${userEmail}</div>
                <div class="dropdown-separator"></div>
                <div class="logout-option" onclick="window.app.logout()">Sign out</div>
            `;
            
            dropdown.style.position = 'absolute';
            dropdown.style.top = '50px';
            dropdown.style.right = '10px';
            dropdown.style.backgroundColor = 'white';
            dropdown.style.boxShadow = '0 2px 10px rgba(0,0,0,0.2)';
            dropdown.style.borderRadius = '8px';
            dropdown.style.minWidth = '220px';
            dropdown.style.zIndex = '1000';
            dropdown.style.display = 'block';
            
            document.body.appendChild(dropdown);
            
            document.addEventListener('click', function closeDropdown(event) {
                if (event.target !== dropdown && !dropdown.contains(event.target) && event.target !== avatar) {
                    dropdown.style.display = 'none';
                }
            });
        });
        
        avatar.style.cursor = 'pointer';
    }
    
    // 3. Enhanced logout function
    if (window.app && typeof window.app.logout === 'function') {
        const originalLogout = window.app.logout;
        
        window.app.logout = function() {
            console.log("Enhanced logout function running");
            
            // Clear authentication data
            localStorage.removeItem('naukriAuthToken');
            localStorage.removeItem('naukriUser');
            
            // Update UI elements
            const loginButton = document.getElementById('loginButton');
            if (loginButton) {
                loginButton.style.display = 'block';
                loginButton.style.visibility = 'visible';
                loginButton.style.opacity = '1';
                loginButton.className = loginButton.className.replace(/hidden|d-none|invisible/g, '');
                console.log("Login button should now be visible");
            }
            
            // Reset avatar
            const userAvatar = document.getElementById('userAvatar');
            if (userAvatar) {
                userAvatar.textContent = 'A';
            }
            
            // Remove dropdown
            const dropdown = document.getElementById('userDropdown');
            if (dropdown) {
                dropdown.remove();
            }
            
            // Show logout message
            alert("You have been successfully logged out.");
        };
    }
    
    // 4. Enhanced hideWelcome function
    const originalHideWelcome = window.hideWelcome;
    window.hideWelcome = function() {
        // Call the original function
        if (typeof originalHideWelcome === 'function') {
            originalHideWelcome();
        }
        
        // Also enhance the spreadsheet
        enhanceSpreadsheet();
    };
});
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add event listeners to handle checkbox behavior
        const googleLoginCheck = document.getElementById('googleLogin');
        const otpLoginCheck = document.getElementById('otpLogin');
        const registerCheck = document.getElementById('registerNew');
        
        // Click handler for Google login
        googleLoginCheck.addEventListener('change', function() {
            if (this.checked) {
                otpLoginCheck.checked = false;
                registerCheck.checked = false;
                
                // In a real implementation, you would redirect to Google auth
                console.log('Redirecting to Google login...');
                
                // For demo purposes, simulate login with Google
                setTimeout(() => {
                    const mockUserData = {
                        id: "google_user123",
                        name: "Google User",
                        email: "user@gmail.com",
                        token: "mock-google-auth-token"
                    };
                    
                    localStorage.setItem('naukriAuthToken', mockUserData.token);
                    localStorage.setItem('naukriUser', JSON.stringify(mockUserData));
                    
                    app.hideLoginModal();
                    app.updateUserInterface();
                    
                    // Uncheck the box after login
                    this.checked = false;
                }, 500);
            }
        });
        
        // Click handler for OTP login
        otpLoginCheck.addEventListener('change', function() {
            if (this.checked) {
                googleLoginCheck.checked = false;
                registerCheck.checked = false;
                
                // In a real implementation, you would show OTP input field
                alert('OTP functionality would be shown here');
                this.checked = false;
            }
        });
        
        // Click handler for registration
        registerCheck.addEventListener('change', function() {
            if (this.checked) {
                googleLoginCheck.checked = false;
                otpLoginCheck.checked = false;
                
                // In a real implementation, you would redirect to registration
                window.open('https://www.naukri.com/registration/createAccount');
                this.checked = false;
            }
        });
    });
    </script>

<script>
    // First, define a simple logging function to help debug
    function debugLog(message) {
        console.log("%c[DEBUG] " + message, "color: blue; font-weight: bold;");
    }
    
    // Immediately set up our click handler directly on the element, bypassing the hideWelcome function
    document.addEventListener('DOMContentLoaded', function() {
        debugLog("Setting up direct click handler for stealth mode button");
        
        const stealthButton = document.querySelector('.got-it-cell');
        if (stealthButton) {
            // Remove the inline onclick attribute to avoid conflicts
            stealthButton.removeAttribute('onclick');
            
            // Add our direct event listener
            stealthButton.addEventListener('click', function() {
                debugLog("Stealth button clicked via direct event listener");
                activateStealthMode();
            });
        } else {
            console.error("Could not find stealth mode button element");
        }
    });
    
    // Create a completely separate function with a unique name
    function activateStealthMode() {
        debugLog("activateStealthMode function executing");
        
        try {
            // Clear the welcome message text in cells
            for (let i = 2; i <= 5; i++) {
                const cell = document.querySelector(`tr:nth-child(${i}) td:nth-child(2)`);
                if (cell) {
                    cell.textContent = "";
                    debugLog(`Cleared content in cell row ${i}`);
                }
            }
            
            // Change the "Activate Stealth Mode" cell
            const gotItCell = document.querySelector('.got-it-cell');
            if (gotItCell) {
                gotItCell.textContent = "HR";
                gotItCell.className = ""; // Remove classes
                gotItCell.style = ""; // Remove styling
                gotItCell.removeAttribute('onclick');
                debugLog("Modified stealth button to show 'HR'");
            }
            
            // Set the flag to avoid showing the welcome message again
            localStorage.setItem('welcomeSeen', 'true');
            debugLog("Set welcomeSeen flag in localStorage");
            
            // Try all possible ways to activate emergency view
            if (typeof emergency !== 'undefined' && emergency.showSpreadsheetView) {
                debugLog("Calling emergency.showSpreadsheetView()");
                emergency.showSpreadsheetView();
            } else if (typeof window.emergency !== 'undefined' && window.emergency.showSpreadsheetView) {
                debugLog("Calling window.emergency.showSpreadsheetView()");
                window.emergency.showSpreadsheetView();
            } else if (typeof app !== 'undefined' && app.showEmergencyView) {
                debugLog("Calling app.showEmergencyView()");
                app.showEmergencyView();
            } else {
                console.error("Could not find emergency view functions");
                // Fallback: let's at least try to populate some data
                populateBudgetData();
            }
        } catch (error) {
            console.error("Error in activateStealthMode:", error);
        }
    }
    
    // Fallback function to populate data if emergency view is not available
    function populateBudgetData() {
        debugLog("Running fallback budget data population");
        
        // Financial data to display
        const financialData = [
            { category: "Marketing", q1: "â‚¹15,750", q2: "â‚¹18,450", q3: "â‚¹21,200", trend: "+12%", status: "On Track" },
            { category: "Sales", q1: "â‚¹42,800", q2: "â‚¹45,100", q3: "â‚¹48,750", trend: "+8%", status: "Exceeding" },
            { category: "R&D", q1: "â‚¹34,200", q2: "â‚¹33,800", q3: "â‚¹36,500", trend: "+5%", status: "On Track" },
            { category: "Operations", q1: "â‚¹28,300", q2: "â‚¹27,900", q3: "â‚¹29,100", trend: "+3%", status: "On Track" },
            { category: "IT", q1: "â‚¹18,400", q2: "â‚¹22,700", q3: "â‚¹19,800", trend: "-13%", status: "Review" },
            { category: "HR", q1: "â‚¹12,100", q2: "â‚¹12,350", q3: "â‚¹12,600", trend: "+2%", status: "On Track" },
            { category: "Admin", q1: "â‚¹8,750", q2: "â‚¹9,200", q3: "â‚¹9,400", trend: "+2%", status: "On Track" }
        ];
        
        // Add financial data rows (rows 2-8)
        financialData.forEach((data, index) => {
            const rowIndex = index + 2; // Starting from row 2
            const row = document.querySelector(`tr:nth-child(${rowIndex})`);
            
            if (row) {
                // Set the category cell (A column)
                const categoryCell = row.querySelector('td:nth-child(2)');
                if (categoryCell) {
                    categoryCell.textContent = data.category;
                    debugLog(`Set ${data.category} in row ${rowIndex}`);
                }
                
                // Set Q1 cell (B column)
                const q1Cell = row.querySelector('td:nth-child(3)');
                if (q1Cell) {
                    q1Cell.textContent = data.q1;
                }
                
                // Set Q2 cell (C column)
                const q2Cell = row.querySelector('td:nth-child(4)');
                if (q2Cell) {
                    q2Cell.textContent = data.q2;
                }
                
                // Set Q3 cell (D column)
                const q3Cell = row.querySelector('td:nth-child(5)');
                if (q3Cell) {
                    q3Cell.textContent = data.q3;
                }
                
                // Set Trend cell (E column)
                const trendCell = row.querySelector('td:nth-child(6)');
                if (trendCell) {
                    trendCell.textContent = data.trend;
                    if (data.trend.includes('-')) {
                        trendCell.style.color = "#EA4335"; // Google red
                    } else {
                        trendCell.style.color = "#34A853"; // Google green
                    }
                }
                
                // Set Status cell (F column)
                const statusCell = row.querySelector('td:nth-child(7)');
                if (statusCell) {
                    statusCell.textContent = data.status;
                    if (data.status === "Review") {
                        statusCell.style.color = "#EA4335"; // Google red
                    } else if (data.status === "Exceeding") {
                        statusCell.style.color = "#34A853"; // Google green
                    }
                }
            }
        });
        
        debugLog("Finished populating budget data");
    }
    
    // Just to be safe, we'll also define the global hideWelcome function
    window.hideWelcome = function() {
        debugLog("Global hideWelcome function called");
        activateStealthMode();
    };
    </script>

<!-- EMERGENCY DIRECT FIX - BYPASSES ALL EXISTING CODE -->
<script>
    // Wait for the full page to load
    window.addEventListener('load', function() {
      console.log('DIRECT FIX: Script loaded');
      
      // Get the stealth mode button
      const stealthButton = document.querySelector('.got-it-cell');
      if (stealthButton) {
        console.log('DIRECT FIX: Found stealth button');
        
        // Add our completely standalone click handler
        stealthButton.addEventListener('click', function(e) {
          console.log('DIRECT FIX: Button clicked');
          
          // Prevent default and stop propagation to avoid any other handlers
          e.preventDefault();
          e.stopPropagation();
          
          try {
            // 1. Clear the welcome messages
            console.log('DIRECT FIX: Clearing welcome messages');
            for (let i = 2; i <= 5; i++) {
              const cell = document.querySelector(`tbody tr:nth-child(${i}) td:nth-child(2)`);
              if (cell) {
                cell.textContent = '';
                console.log(`DIRECT FIX: Cleared row ${i}`);
              }
            }
            
            // 2. Update the button cell
            console.log('DIRECT FIX: Updating button cell');
            stealthButton.textContent = 'HR';
            stealthButton.className = '';
            stealthButton.style.cursor = 'default';
            
            // Set a flag for next load
            localStorage.setItem('welcomeSeen', 'true');
            
            // 3. Add the budget data directly
            console.log('DIRECT FIX: Adding budget data');
            
            // Define budget data
            const budgetData = [
              { category: "Marketing", q1: "â‚¹15,750", q2: "â‚¹18,450", q3: "â‚¹21,200", trend: "+12%", status: "On Track" },
              { category: "Sales", q1: "â‚¹42,800", q2: "â‚¹45,100", q3: "â‚¹48,750", trend: "+8%", status: "Exceeding" },
              { category: "R&D", q1: "â‚¹34,200", q2: "â‚¹33,800", q3: "â‚¹36,500", trend: "+5%", status: "On Track" },
              { category: "Operations", q1: "â‚¹28,300", q2: "â‚¹27,900", q3: "â‚¹29,100", trend: "+3%", status: "On Track" },
              { category: "IT", q1: "â‚¹18,400", q2: "â‚¹22,700", q3: "â‚¹19,800", trend: "-13%", status: "Review" },
              { category: "HR", q1: "â‚¹12,100", q2: "â‚¹12,350", q3: "â‚¹12,600", trend: "+2%", status: "On Track" },
              { category: "Admin", q1: "â‚¹8,750", q2: "â‚¹9,200", q3: "â‚¹9,400", trend: "+2%", status: "On Track" }
            ];
            
            // Add data rows
            budgetData.forEach((data, index) => {
              const rowIndex = index + 2;  // Start at row 2
              const row = document.querySelector(`tbody tr:nth-child(${rowIndex})`);
              
              if (row) {
                // Category (A column)
                const catCell = row.querySelector('td:nth-child(2)');
                if (catCell) {
                  catCell.textContent = data.category;
                  console.log(`DIRECT FIX: Added ${data.category} to row ${rowIndex}`);
                }
                
                // Q1 (B column)
                const q1Cell = row.querySelector('td:nth-child(3)');
                if (q1Cell) q1Cell.textContent = data.q1;
                
                // Q2 (C column)
                const q2Cell = row.querySelector('td:nth-child(4)');
                if (q2Cell) q2Cell.textContent = data.q2;
                
                // Q3 (D column)
                const q3Cell = row.querySelector('td:nth-child(5)');
                if (q3Cell) q3Cell.textContent = data.q3;
                
                // Trend (E column)
                const trendCell = row.querySelector('td:nth-child(6)');
                if (trendCell) {
                  trendCell.textContent = data.trend;
                  if (data.trend.includes('-')) {
                    trendCell.style.color = "#EA4335"; // Red
                  } else {
                    trendCell.style.color = "#34A853"; // Green
                  }
                }
                
                // Status (F column)
                const statusCell = row.querySelector('td:nth-child(7)');
                if (statusCell) {
                  statusCell.textContent = data.status;
                  if (data.status === "Review") {
                    statusCell.style.color = "#EA4335"; // Red
                  } else if (data.status === "Exceeding") {
                    statusCell.style.color = "#34A853"; // Green
                  }
                }
              }
            });
            
            console.log('DIRECT FIX: Success!');
          } catch (error) {
            console.error('DIRECT FIX ERROR:', error);
          }
          
          return false;
        });
        
        console.log('DIRECT FIX: Click handler attached successfully');
      } else {
        console.error('DIRECT FIX: Could not find stealth button element');
      }
    });
  </script>

<!-- FIX FOR AVATAR CLICK AREA -->
<script>
    window.addEventListener('load', function() {
      // Get the avatar element
      const avatar = document.getElementById('userAvatar');
      
      if (avatar) {
        console.log('Avatar element found, applying fix...');
        
        // Make sure it's using block display and has sufficient size
        avatar.style.display = 'flex';
        avatar.style.justifyContent = 'center';
        avatar.style.alignItems = 'center';
        avatar.style.minWidth = '32px';
        avatar.style.minHeight = '32px';
        avatar.style.cursor = 'pointer';
        
        // Completely replace the click handler to ensure it works on the entire element
        avatar.removeEventListener('click', avatar.onclick);
        
        avatar.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          console.log('Avatar clicked (new handler)');
          
          let dropdown = document.getElementById('userDropdown');
          
          if (dropdown) {
            if (dropdown.style.display === 'block') {
              dropdown.style.display = 'none';
            } else {
              dropdown.style.display = 'block';
            }
            return;
          }
          
          dropdown = document.createElement('div');
          dropdown.id = 'userDropdown';
          dropdown.className = 'user-dropdown';
          
          const userData = JSON.parse(localStorage.getItem('naukriUser') || '{}');
          const userName = userData.name || 'Guest User';
          const userEmail = userData.email || '';
          
          dropdown.innerHTML = `
              <div class="user-info">${userName}</div>
              <div class="email-info">${userEmail}</div>
              <div class="dropdown-separator"></div>
              <div class="logout-option" onclick="window.app.logout()">Sign out</div>
          `;
          
          dropdown.style.position = 'absolute';
          dropdown.style.top = '50px';
          dropdown.style.right = '10px';
          dropdown.style.backgroundColor = 'white';
          dropdown.style.boxShadow = '0 2px 10px rgba(0,0,0,0.2)';
          dropdown.style.borderRadius = '8px';
          dropdown.style.minWidth = '220px';
          dropdown.style.zIndex = '1000';
          dropdown.style.display = 'block';
          
          document.body.appendChild(dropdown);
          
          // Create document click handler to close dropdown when clicking elsewhere
          document.addEventListener('click', function closeDropdown(event) {
            if (event.target !== dropdown && !dropdown.contains(event.target) && event.target !== avatar) {
              dropdown.style.display = 'none';
            }
          });
        });
        
        console.log('Avatar click area fix applied');
      } else {
        console.error('Avatar element not found');
      }
    });
    </script>

</body>
</html>