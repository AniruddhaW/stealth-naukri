<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quarterly Budget Review - Google Sheets</title>
    <link rel="icon" href="https://ssl.gstatic.com/docs/spreadsheets/spreadsheets_launcher_icon.png" type="image/png">
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="app-container">
        <button class="emergency-exit" onclick="app.showEmergencyView()">ESC</button>
        
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="sheets-logo">
                    <img src="assets/sheets-logo.png" alt="Sheets">
                    <div class="sheets-title">Quarterly Budget Review</div>
                </div>
                <button class="star-btn">â˜†</button>
            </div>
            <div class="header-right">
                <button class="share-btn">
                    <span class="share-icon">ðŸ”’</span>
                    Share
                </button>
                <div class="avatar" id="userAvatar">A</div>
            </div>
        </div>
        
        <!-- Menu bar -->
        <div class="menu-bar">
            <div class="menu-item">File</div>
            <div class="menu-item">Edit</div>
            <div class="menu-item">View</div>
            <div class="menu-item">Insert</div>
            <div class="menu-item">Format</div>
            <div class="menu-item">Data</div>
            <div class="menu-item">Tools</div>
            <div class="menu-item">Extensions</div>
            <div class="menu-item">Help</div>
        </div>
        
        <!-- Toolbar -->
        <div class="toolbar">
            <!-- Left section -->
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Search (âŒ˜F)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Undo (âŒ˜Z)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Redo (âŒ˜Y)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Print (âŒ˜P)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Paint format">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M18 4V3c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V6h1v4H9v11c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-9h8V4h-3z" fill="#5f6368"/></svg>
                </button>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <div class="toolbar-select">
                    <span>100%</span>
                    <svg width="18" height="18" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z" fill="#5f6368"/></svg>
                </div>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Currency">
                    <span>$</span>
                </button>
                <button class="toolbar-btn" title="Percent">
                    <span>%</span>
                </button>
                <button class="toolbar-btn" title="Decrease decimal places">
                    <span>.0</span>
                </button>
                <button class="toolbar-btn" title="Increase decimal places">
                    <span>.00</span>
                </button>
                <button class="toolbar-btn" title="More formats">
                    <span>123</span>
                </button>
            </div>
        
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <div class="toolbar-select font-select">
                    <span>Default</span>
                    <svg width="18" height="18" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z" fill="#5f6368"/></svg>
                </div>
            </div>
        
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn font-size-decrease" title="Decrease font size">
                    <span>âˆ’</span>
                </button>
                <div class="toolbar-select size-select">
                    <span>10</span>
                </div>
                <button class="toolbar-btn font-size-increase" title="Increase font size">
                    <span>+</span>
                </button>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Bold (âŒ˜B)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Italic (âŒ˜I)">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Strikethrough">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M10 19h4v-3h-4v3zM5 4v3h5v3h4V7h5V4H5zM3 14h18v-2H3v2z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Text color">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M11 3L5.5 17h2.25l1.12-3h6.25l1.12 3h2.25L13 3h-2zm-1.38 9L12 5.67 14.38 12H9.62z" fill="#5f6368"/><path d="M3 19h18v3H3v-3z" fill="#34a853"/></svg>
                </button>
                <button class="toolbar-btn" title="Fill color">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z" fill="#5f6368"/><path d="M0 20h24v4H0v-4z" fill="#fbbc05"/></svg>
                </button>
            </div>
        
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Borders">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M3 3v18h18V3H3zm8 16H5v-6h6v6zm0-8H5V5h6v6zm8 8h-6v-6h6v6zm0-8h-6V5h6v6z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Merge cells">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM4 18V6h16v12H4z M7 8h10v2H7z M7 12h10v2H7z" fill="#5f6368"/></svg>
                </button>
            </div>
        
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" title="Horizontal align">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Vertical align">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M8 19h3v4h2v-4h3l-4-4-4 4zm8-14h-3V1h-2v4H8l4 4 4-4zM4 11v2h16v-2H4z" fill="#5f6368"/></svg>
                </button>
                <button class="toolbar-btn" title="Text wrapping">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3 3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z" fill="#5f6368"/></svg>
                </button>
            </div>
        
            <div class="toolbar-group" style="margin-left: auto;">
                <button class="toolbar-btn" title="More">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill="#5f6368"/></svg>
                </button>
            </div>
            
            <button class="login-btn" id="loginButton" onclick="app.showLoginModal()">Login</button>
            <div class="help-button" onclick="app.showHelpModal()">?</div>
        </div>
        
        <!-- Formula bar -->
        <div class="formula-bar">
            <div class="cell-reference">A1</div>
            <div class="formula-input">
                <div class="formula-equals">=</div>
                <input type="text" class="formula-field" id="searchInput" placeholder="Type job title, skills or company">
            </div>
        </div>
        
        <!-- Welcome message -->
        <div class="welcome-message" id="welcomeMessage">
            <h2>Shhh... This isn't a job portal.</h2>
            <p>It's just a totally normal spreadsheet ðŸ‘€</p>
            <p>Type your dream job below, scroll like you're working,<br>
            and apply without raising a single eyebrow.</p>
            <button class="got-it-btn" onclick="hideWelcome()">Got it</button>
        </div>
        
        <!-- Spreadsheet area -->
        <div class="spreadsheet-container">
            <div class="formula-cell-reference">E12</div>
            <div class="formula-function">fx</div>
            
            <table class="spreadsheet">
                <thead>
                    <tr>
                        <th class="row-header"></th>
                        <th>A</th>
                        <th>B</th>
                        <th>C</th>
                        <th>D</th>
                        <th>E</th>
                        <th>F</th>
                        <th>G</th>
                        <th>H</th>
                        <th>I</th>
                        <th>J</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="row-header">1</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">2</td>
                        <td>Shhh... This isn't a job portal.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">3</td>
                        <td>It's just a totally normal spreadsheet ðŸ‘€</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">4</td>
                        <td>Type your dream job below, scroll like you're working,</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">5</td>
                        <td>and apply without raising a single eyebrow.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">6</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">7</td>
                        <td class="got-it-cell" onclick="hideWelcome()">Got it</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">8</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">9</td>
                        <td>Type job title here...</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">10</td>
                        <td class="header-cell">Company</td>
                        <td class="header-cell">Position</td>
                        <td class="header-cell">Location</td>
                        <td class="header-cell">Salary</td>
                        <td class="header-cell">Experience</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">11</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="row-header">12</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td class="active-cell" id="searchCell"></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr id="results-container">
                        <td colspan="11" class="results-wrapper">
                            <div id="results"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Sheet tabs -->
        <div class="sheets-tabs">
            <div class="sheet-tab">Sheet1</div>
            <div class="add-sheet">+</div>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Login to Naukri</div>
                <div class="modal-close" onclick="app.hideLoginModal()">Ã—</div>
            </div>
            
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label class="form-label" for="email">Email</label>
                    <input type="email" id="email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="password">Password</label>
                    <input type="password" id="password" class="form-input" required>
                </div>
                <div class="form-footer">
                    <div class="create-account" onclick="window.open('https://www.naukri.com/registration/createAccount')">Create an account</div>
                    <button type="submit" class="login-submit">Login</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Load JavaScript -->
    <script src="js/api.js"></script>
    <script src="js/search.js"></script>
    <script src="js/emergency.js"></script>
    <script src="js/app.js"></script>

    <script>
        function hideWelcome() {
            console.log("Running hideWelcome function");
            
            // Hide the welcome message
            document.getElementById('welcomeMessage').style.display = 'none';
            localStorage.setItem('welcomeSeen', 'true');
            
            // Clear the results container
            document.getElementById('results').innerHTML = '';
            
            // Get all rows in the table
            const tbody = document.querySelector('table.spreadsheet > tbody');
            const allRows = Array.from(tbody.querySelectorAll('tr:not(#results-container)'));
            console.log("Initial rows count:", allRows.length);
            
            // Find job search rows (rows 9+)
            const jobRows = allRows.filter(row => {
                const rowHeader = row.querySelector('.row-header');
                if (!rowHeader) return false;
                
                const rowNum = parseInt(rowHeader.textContent);
                return rowNum >= 9;
            });
            
            // Remove all rows except job search rows
            allRows.forEach(row => {
                const rowHeader = row.querySelector('.row-header');
                if (!rowHeader) return;
                
                const rowNum = parseInt(rowHeader.textContent);
                if (rowNum < 9) {
                    row.parentNode.removeChild(row);
                }
            });
            
            // Create financial data rows
            const financialData = [
                { row: 1, category: "Category", q1: "Q1 2023", q2: "Q2 2023", q3: "Q3 2023", trend: "Trend", status: "Status", isHeader: true },
                { row: 2, category: "Marketing", q1: "â‚¹15,750", q2: "â‚¹18,450", q3: "â‚¹21,200", trend: "+12%", status: "On Track", trendColor: "#34A853" },
                { row: 3, category: "Sales", q1: "â‚¹42,800", q2: "â‚¹45,100", q3: "â‚¹48,750", trend: "+8%", status: "Exceeding", trendColor: "#34A853", statusColor: "#34A853" },
                { row: 4, category: "R&D", q1: "â‚¹34,200", q2: "â‚¹33,800", q3: "â‚¹36,500", trend: "+5%", status: "On Track", trendColor: "#34A853" },
                { row: 5, category: "IT", q1: "â‚¹18,400", q2: "â‚¹22,700", q3: "â‚¹19,800", trend: "-13%", status: "Review", trendColor: "#EA4335", statusColor: "#EA4335" },
                { row: 6, category: "Admin", q1: "â‚¹9,800", q2: "â‚¹10,250", q3: "â‚¹10,400", trend: "+2%", status: "On Track", trendColor: "#34A853" },
                { row: 7, category: "Total", q1: "â‚¹160,300", q2: "â‚¹169,500", q3: "â‚¹177,350", trend: "+5%", status: "", trendColor: "#34A853", isBold: true },
                { row: 8, blank: true }
            ];
            
            // Get reference to the first job row to insert before
            const firstJobRow = jobRows.length > 0 ? jobRows[0] : null;
            console.log("First job row:", firstJobRow ? firstJobRow.querySelector('.row-header').textContent : "none");
            
            // Insert rows in order
            let previousRow = null;
            for (const data of financialData) {
                const newRow = document.createElement('tr');
                
                if (data.blank) {
                    // Create an empty row
                    newRow.innerHTML = `
                        <td class="row-header">${data.row}</td>
                        <td></td><td></td><td></td><td></td><td></td>
                        <td></td><td></td><td></td><td></td><td></td>
                    `;
                } else {
                    newRow.innerHTML = `
                        <td class="row-header">${data.row}</td>
                        <td ${data.isHeader ? 'class="header-cell"' : ''} ${data.isBold ? 'style="font-weight:bold"' : ''}>${data.category}</td>
                        <td ${data.isHeader ? 'class="header-cell"' : ''}>${data.q1}</td>
                        <td ${data.isHeader ? 'class="header-cell"' : ''}>${data.q2}</td>
                        <td ${data.isHeader ? 'class="header-cell"' : ''}>${data.q3}</td>
                        <td ${data.isHeader ? 'class="header-cell"' : ''} ${data.trendColor ? `style="color:${data.trendColor}"` : ''}>${data.trend}</td>
                        <td ${data.isHeader ? 'class="header-cell"' : ''} ${data.statusColor ? `style="color:${data.statusColor}"` : ''}>${data.status}</td>
                        <td></td><td></td><td></td><td></td>
                    `;
                }
                
                if (previousRow) {
                    // Insert after previous row
                    previousRow.after(newRow);
                } else if (firstJobRow) {
                    // Insert before first job row
                    tbody.insertBefore(newRow, firstJobRow);
                } else {
                    // Append to tbody
                    tbody.insertBefore(newRow, document.getElementById('results-container'));
                }
                
                previousRow = newRow;
            }
            
            console.log("Final rows count:", tbody.querySelectorAll('tr:not(#results-container)').length);
            
            // Focus on the search cell
            document.getElementById('searchCell').focus();
        }
    </script>
</body>
</html>